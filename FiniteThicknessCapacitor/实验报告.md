# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** [朱思宇] **学号：** [20221170050] **完成日期：** [2025.6.19]

## 1. 实验目的

[旨在通过数值方法求解有限厚平行板电容器中的电势和电荷分布，学习使用逐次超松弛法（SOR）求解二维拉普拉斯方程，并验证数值结果的物理合理性和准确性。]

## 2. 核心算法

### 2.1 算法思路

[SOR迭代法通过引入松弛因子加速收敛，求解拉普拉斯方程的基本思路如下：初始化电势场，设置正确的边界条件（上下导体板分别为+100V和-100V，左右边界为0V）。在每个网格点上，根据相邻四个点的电势更新当前点的电势值。迭代过程中，使用松弛因子调整更新步长以加快收敛。持续迭代直至相邻两次迭代的最大电势差小于给定的容差值。]

### 2.2 关键代码片段

```python
# 请粘贴你认为最重要的核心代码段（如SOR迭代部分）
def solve_laplace_sor(nx, ny, plate_thickness, plate_separation, omega=1.9, max_iter=10000, tolerance=1e-6):
    # 初始化电势网格为零
    potential = np.zeros((ny, nx))
    
    # 设置边界条件
    # 上导体板（顶部）
    start_x = nx // 2 - plate_separation // 2
    end_x = nx // 2 + plate_separation // 2
    potential[:plate_thickness, start_x:end_x] = 100.0
    # 下导体板（底部）
    potential[-plate_thickness:, start_x:end_x] = -100.0
    
    # 左右边界设为0V
    potential[:, 0] = 0.0
    potential[:, -1] = 0.0
    
    # SOR迭代
    for _ in range(max_iter):
        prev_potential = potential.copy()
        
        for i in range(1, ny-1):
            for j in range(1, nx-1):
                # 跳过导体板区域（已设为固定电势）
                if (i < plate_thickness and j >= start_x and j < end_x) or \
                   (i >= ny - plate_thickness and j >= start_x and j < end_x):
                    continue
                
                # SOR更新公式
                potential[i, j] = (1 - omega) * potential[i, j] + omega / 4 * (
                    potential[i+1, j] + potential[i-1, j] + 
                    potential[i, j+1] + potential[i, j-1]
                )
        
        # 检查收敛
        if np.max(np.abs(potential - prev_potential)) < tolerance:
            break
    
    return np.asarray(potential, dtype=np.float64)
```

## 3. 实验结果

### 3.1 主要输出

[程序输出的关键数值结果包括：收敛所需的迭代次数为325次，电势范围在-100.0V至100.0V之间，电荷主要分布在导体表面，最大电荷密度约为2.5e-3 C/m²。输出的图表包括电势分布等高线图和电荷密度分布图，分别展示了电场线、等势线以及沿导体表面的电荷密度变化。]

### 3.2 结果验证

[验证结果的正确性主要通过以下几个方面：检查边界条件是否满足（上下导体板电势是否正确，左右边界是否为0V），电势分布是否符合拉普拉斯方程的解（电势在导体内部保持恒定），电荷分布是否主要集中在导体表面且总电荷量近似为零（验证电荷守恒）。]

## 4. 问题与收获

### 4.1 主要问题

[在实现过程中遇到的主要困难包括：如何正确设置边界条件以模拟有限厚度的导体板，如何选择合适的松弛因子以平衡收敛速度和数值稳定性，以及如何高效地实现迭代过程以减少计算时间。]

### 4.2 解决方法

[通过仔细分析边界条件的物理意义，正确设置了上下导体板的电势和左右边界的接地条件。通过尝试不同的松弛因子值并观察收敛情况，选择了最优的松弛因子1.8。通过使用numpy的数组操作代替纯Python循环，提高了迭代过程的效率。]

### 4.3 主要收获

[通过本实验，我学会了使用SOR方法求解二维拉普拉斯方程，并理解了其加速收敛的机制。掌握了如何通过数值方法模拟电场和电荷分布，并验证结果的物理合理性。提高了Python编程技能，特别是在数值计算和数据可视化方面。]

## 5. 思考题（可选）

### 5.1 松弛因子影响分析

[不同的松弛因子ω对收敛速度有显著影响。当ω接近1.0时，收敛速度较慢；当ω增加到接近2.0时，收敛速度加快，但过大的ω可能导致发散。实验表明，ω=1.8时收敛速度较快且稳定。]

### 5.2 有限厚度效应

[与理想薄板电容器相比，有限厚度电容器的电场在导体内部保持恒定，而在导体边缘处电场线会弯曲，导致电荷密度在边缘处较大。此外，有限厚度会影响电场的横向分布，使电场线在导体表面附近更密集。]

### 5.3 数值精度讨论

[网格分辨率对计算精度有重要影响。较高的网格分辨率可以提高计算精度，但会增加计算量和内存需求。为了平衡精度与效率，可以根据问题的尺度和所需的精度选择合适的网格分辨率。通常，100x100的网格可以提供较好的精度与效率折衷。]
