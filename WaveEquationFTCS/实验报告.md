# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [朱思宇] **学号：** [20221170050] **完成日期：** [2025.6.20]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 核心代码段
# 例如：FTCS更新公式的实现
# for j in range(1, t.size - 1):
#     u[1:-1, j + 1] = c_val * (u[2:, j] + u[:-2, j]) + 2 * (1 - c_val) * u[1:-1, j] - u[1:-1, j - 1]
```

## 3. 实验结果

### 3.1 主要输出

[![image](https://github.com/user-attachments/assets/a5a7a81a-fe11-4514-b221-8cb62696317e)
]

### 3.2 结果验证

[边界条件验证：检查弦的两端（ x=0 和 x=L ）在所有时间步的位移是否始终为零。通过查看解数组 u 的首列和末列，确认其值均为零，满足固定边界条件。
波形合理性验证：观察动画中弦的振动波形是否符合物理预期。在初始阶段，弦应该根据初始速度剖面开始振动，形成波包并向两端传播。随着波的传播，波形应保持一定的形状并在边界反射。数值稳定性验证：检查数值解是否出现发散现象，如位移值是否异常增大。在实验中，通过设置合理的时间步长 Δt 和空间步长 Δx，确保 c<1，从而满足数值稳定条件。]

## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？A:初始速度条件涉及到对时间导数的处理，需要将其离散化并应用到第一个时间步的计算中。这涉及到对波动方程的正确理解以及差分公式的应用，稍有不慎就可能出错，导致模拟结果不准确。
*   如何确保数值稳定性？A:数值解的稳定性是有限差分法中一个关键问题。如果时间步长和空间步长选择不当，数值解可能会发散，无法正确反映物理现象。需要理解并应用CFL条件来确保数值稳定性。
*   动画制作中的挑战？A:创建动态模拟动画需要对Matplotlib动画模块有深入的理解。如何设置动画的更新函数、控制动画的流畅性和视觉效果等都是需要解决的问题。]

### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。A:通过仔细研究波动方程的差分形式，理解如何将初始速度条件离散化。查阅相关教材和资料，学习如何将初始速度剖面函数应用于第一个时间步的位移计算。
*   调整时间步长以满足CFL条件。A:学习CFL条件，理解其对数值稳定性的意义。通过调整时间步长和空间步长，确保 c<1，从而避免数值解的发散。在实验中，选择合适的 Δt 和 Δx 值来满足稳定性条件。
*   学习Matplotlib动画模块的使用。A:学习Matplotlib动画模块的使用，特别是 FuncAnimation 的参数设置和更新函数的编写。通过反复试验和调试，确保动画能够正确、流畅地展示弦的振动过程。查阅官方文档和相关教程，掌握动画制作的技巧。]

### 4.3 主要收获

[请在此处总结你在本次实验中的3-5句话学习收获，例如：
*   加深了对波动方程和有限差分法的理解。A:通过本次实验，加深了对一维波动方程及其数值解法的理解，掌握了FTCS有限差分方案的原理和实现步骤。
*   掌握了Python进行科学计算和可视化的技能。A:熟练运用Python中的NumPy库进行数值计算，运用Matplotlib库进行数据可视化和动画制作，提升了编程能力和数据处理能力。
*   认识到数值模拟中稳定性条件的重要性。A:了解到数值模拟中稳定性条件的关键作用，学会了如何通过调整参数来确保数值解的稳定性，避免因不满足稳定性条件而导致的数值发散问题。]

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？[A:如果改变初始速度剖面的形状，例如调整高斯函数的振幅、偏移量或宽度，弦的振动模式会相应地发生变化。振幅的改变会影响振动的能量大小，导致波形的幅度变化；偏移量的改变会改变波包的初始位置，影响波的传播方向和反射特性；宽度的改变会影响波包的集中程度，进而影响波的传播速度和形状变化。]
2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？[A:当改变 Δt 和 Δx 的值时，数值解的稳定性和准确性会受到显著影响。如果 Δt 相对于 Δx 过大，导致 c≥1，数值解可能会发散，无法正确模拟物理过程。相反，如果 Δt 和 Δx 满足 c<1，数值解将保持稳定，能够准确地反映弦的振动模式。此外，减小 Δx 和 Δt 通常会提高数值解的精度，但也增加了计算量。]
